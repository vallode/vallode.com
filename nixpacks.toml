providers = ['node']

[phases.setup]
nixPkgs = ['nodejs_20']
cmds = [
  "curl -fsSL https://deno.land/x/install/install.sh | sh -s v2.6.9",
  "ln -sf /root/.deno/bin/deno /usr/local/bin/deno"
]

[phases.install]
cmds = ['deno install']
cacheDirectories = ['node_modules']

[phases.build]
cmds = ['deno run build']
cacheDirectories = ['.astro']